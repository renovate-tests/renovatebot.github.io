



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="How to support private npm  modules when using Renovate">
      
      
        <link rel="canonical" href="https://docs.renovatebot.com/private-modules/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/logo.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.6.3">
    
    
      
        <title>Private npm module support</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.adb8469c.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#2196f3">
      
    
    
      <script src="../assets/javascripts/modernizr.86422ebf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../assets/css/style.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="blue" data-md-color-accent="blue">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#private-npm-module-support" tabindex="0" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://docs.renovatebot.com" title="Renovate Docs" aria-label="Renovate Docs" class="md-header-nav__button md-logo">
          
            <img alt="logo" src="../assets/images/logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Renovate Docs
            </span>
            <span class="md-header-nav__topic">
              
                Private npm module support
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" aria-label="search" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://docs.renovatebot.com" title="Renovate Docs" class="md-nav__button md-logo">
      
        <img alt="logo" src="../assets/images/logo.png" width="48" height="48">
      
    </a>
    Renovate Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Getting Started
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Getting Started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../install-github-app/" title="GitHub App Installation" class="md-nav__link">
      GitHub App Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../install-gitlab-app/" title="GitLab App Installation" class="md-nav__link">
      GitLab App Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../self-hosting/" title="Self-hosting" class="md-nav__link">
      Self-hosting
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../configure-renovate/" title="Configure Renovate (Onboarding PR)" class="md-nav__link">
      Configure Renovate (Onboarding PR)
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Private npm module support
      </label>
    
    <a href="./" title="Private npm module support" class="md-nav__link md-nav__link--active">
      Private npm module support
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#when-are-npm-private-modules-used" class="md-nav__link">
    When are npm private modules used?
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-module-lookup" class="md-nav__link">
    1. Module lookup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-lock-file-generation" class="md-nav__link">
    2. Lock file generation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#supported-npm-authentication-approaches" class="md-nav__link">
    Supported npm authentication approaches
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-hostrule-to-bots-config" class="md-nav__link">
    Add hostRule to bots config
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#commit-npmrc-file-into-repository" class="md-nav__link">
    Commit .npmrc file into repository
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-npmrc-string-to-renovate-config" class="md-nav__link">
    Add npmrc string to Renovate config
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-npmtoken-to-renovate-config" class="md-nav__link">
    Add npmToken to Renovate config
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-an-encrypted-npm-token-to-renovate-config" class="md-nav__link">
    Add an encrypted npm token to Renovate config
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#encrypted-entire-npmrc-file-into-config" class="md-nav__link">
    Encrypted entire .npmrc file into config
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../reconfigure-renovate/" title="Reconfiguring Renovate" class="md-nav__link">
      Reconfiguring Renovate
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../faq/" title="Frequently Asked Questions" class="md-nav__link">
      Frequently Asked Questions
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../configuration-options/" title="Configuration Options" class="md-nav__link">
      Configuration Options
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../self-hosted-configuration/" title="Self Hosted Configuration" class="md-nav__link">
      Self Hosted Configuration
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Renovate Modules
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Renovate Modules
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../modules/platform/" title="Platforms" class="md-nav__link">
      Platforms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../modules/manager/" title="Managers" class="md-nav__link">
      Managers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../modules/datasource/" title="Datasources" class="md-nav__link">
      Datasources
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../modules/versioning/" title="Versioning" class="md-nav__link">
      Versioning
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../config-presets/" title="Shareable Config Presets" class="md-nav__link">
      Shareable Config Presets
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Language Support
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Language Support
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../bazel/" title="Bazel" class="md-nav__link">
      Bazel
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../docker/" title="Docker" class="md-nav__link">
      Docker
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../golang/" title="Golang" class="md-nav__link">
      Golang
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../java/" title="Java" class="md-nav__link">
      Java
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../javascript/" title="JavaScript" class="md-nav__link">
      JavaScript
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../node/" title="Node.js Versions" class="md-nav__link">
      Node.js Versions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nuget/" title="Nuget" class="md-nav__link">
      Nuget
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../php/" title="PHP" class="md-nav__link">
      PHP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../python/" title="Python" class="md-nav__link">
      Python
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ruby/" title="Ruby" class="md-nav__link">
      Ruby
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Deep Dives
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        Deep Dives
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../dependency-pinning/" title="Should you Pin your Javascript Dependencies?" class="md-nav__link">
      Should you Pin your Javascript Dependencies?
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../configuration-templates/" title="Config Template Editing" class="md-nav__link">
      Config Template Editing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../updating-rebasing/" title="Updating and Rebasing Branches" class="md-nav__link">
      Updating and Rebasing Branches
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../semantic-commits/" title="Semantic Commit Messages" class="md-nav__link">
      Semantic Commit Messages
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../noise-reduction/" title="Noise Reduction" class="md-nav__link">
      Noise Reduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../automerge-configuration/" title="Automerging Updates" class="md-nav__link">
      Automerging Updates
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      Included Presets
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        Included Presets
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../presets-config/" title="Full Config Presets" class="md-nav__link">
      Full Config Presets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../presets-default/" title="Default Presets" class="md-nav__link">
      Default Presets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../presets-docker/" title="Docker Presets" class="md-nav__link">
      Docker Presets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../presets-group/" title="Group Presets" class="md-nav__link">
      Group Presets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../presets-helpers/" title="Helper Presets" class="md-nav__link">
      Helper Presets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../presets-monorepo/" title="Monorepo Presets" class="md-nav__link">
      Monorepo Presets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../presets-packages/" title="Package Presets" class="md-nav__link">
      Package Presets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../presets-preview/" title="Preview Presets" class="md-nav__link">
      Preview Presets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../presets-schedule/" title="Schedule Presets" class="md-nav__link">
      Schedule Presets
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11" type="checkbox" id="nav-11">
    
    <label class="md-nav__link" for="nav-11">
      All Other
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-11">
        All Other
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../merge-confidence/" title="Merge Confidence" class="md-nav__link">
      Merge Confidence
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../templates/" title="Templates" class="md-nav__link">
      Templates
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#when-are-npm-private-modules-used" class="md-nav__link">
    When are npm private modules used?
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-module-lookup" class="md-nav__link">
    1. Module lookup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-lock-file-generation" class="md-nav__link">
    2. Lock file generation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#supported-npm-authentication-approaches" class="md-nav__link">
    Supported npm authentication approaches
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-hostrule-to-bots-config" class="md-nav__link">
    Add hostRule to bots config
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#commit-npmrc-file-into-repository" class="md-nav__link">
    Commit .npmrc file into repository
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-npmrc-string-to-renovate-config" class="md-nav__link">
    Add npmrc string to Renovate config
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-npmtoken-to-renovate-config" class="md-nav__link">
    Add npmToken to Renovate config
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-an-encrypted-npm-token-to-renovate-config" class="md-nav__link">
    Add an encrypted npm token to Renovate config
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#encrypted-entire-npmrc-file-into-config" class="md-nav__link">
    Encrypted entire .npmrc file into config
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="private-npm-module-support">Private npm module support</h1>
<h2 id="when-are-npm-private-modules-used">When are npm private modules used?</h2>
<p>Private npm modules are used at two times during Renovate's process.</p>
<h3 id="1-module-lookup">1. Module lookup</h3>
<p>If a private npm module is listed as a dependency in a <code>package.json</code>, then Renovate will attempt to keep it up-to-date by querying the npm registry like it would for any other package.
Hence, by default with no configuration a private package lookup will fail, because of lack of credentials.
This means it won't be "renovated" and its version will remain unchanged in the package file unless you update it manually.
These failures don't affect Renovate's ability to look up <em>other</em> modules in the same package file.</p>
<p>Assuming the private module lookup succeeds (solutions for that are described later in this document) then private package versions will be kept up-to-date like public package versions are.</p>
<h3 id="2-lock-file-generation">2. Lock file generation</h3>
<p>If you are using a lock file (e.g. Yarn's <code>yarn.lock</code> or npm's <code>package-lock.json</code>) then Renovate needs to update that lock file whenever <em>any</em> package listed in your package file is updated to a new version.</p>
<p>To do this, Renovate will run <code>npm install</code> or equivalent and save the resulting lock file.
If a private module hasn't been updated, it <em>usually</em> won't matter to npm/Yarn because they won't attempt to update its lock file entry anyway.
However it's possible that the install will fail if it attempts to look up that private module for some reason, even when that private module is not the main one being updated.
It's therefore better to provide Renovate with all the credentials it needs to look up private packages.</p>
<h2 id="supported-npm-authentication-approaches">Supported npm authentication approaches</h2>
<p>The recommended approaches in order of preference are:</p>
<p><strong>Self-hosted hostRules</strong>: Configure a hostRules entry in the bot's <code>config.js</code> with the <code>hostType</code>, <code>hostName</code> and <code>token</code> specified</p>
<p><strong>Self-hosted .npmrc</strong>: copy an <code>.npmrc</code> file to the home dir of the bot.</p>
<p><strong>Renovate App with private modules from npmjs.org</strong>: Add an encrypted <code>npmToken</code> to your Renovate config</p>
<p><strong>Renovate App with a private registry</strong>: Add an unencrypted <code>npmrc</code> plus an encrypted <code>npmToken</code> in config</p>
<p>All the various approaches are described below:</p>
<h3 id="add-hostrule-to-bots-config">Add hostRule to bots config</h3>
<p>Define <code>hostRules</code> like this:</p>
<pre><code class="js">module.exports = {
  hostRules: [
    {
      hostType: 'npm',
      hostName: 'registry.npmjs.org',
      token: process.env.NPMJS_TOKEN,
    },
    {
      hostType: 'npm',
      baseUrl:
        'https://pkgs.dev.azure.com/{organization}/_packaging/{feed}/npm/registry/',
      username: 'VssSessionToken',
      password: process.env.AZURE_NPM_TOKEN,
    },
  ],
};
</code></pre>

<p><strong>NOTE:</strong> Do not use <code>NPM_TOKEN</code> as an environment variable, it's incompatible with <code>hostRules</code> and will be deprecated soon.</p>
<h3 id="commit-npmrc-file-into-repository">Commit .npmrc file into repository</h3>
<p>One approach that many projects use for private repositories is to simply check in an authenticated <code>.npmrc</code> into the repository that is then shared between all developers.
Therefore anyone running <code>npm install</code> or <code>yarn install</code> from the project root will be automatically authenticated with npm without having to distribute npm logins to every developer and make sure they've run <code>npm login</code> first before installing.</p>
<p>The good news is that this works for Renovate too.
If Renovate detects a <code>.npmrc</code> or <code>.yarnrc</code> file then it will use it for its install.</p>
<p>Does not work if using binarySource=docker.
<em>This method will be deprecated soon</em></p>
<h3 id="add-npmrc-string-to-renovate-config">Add npmrc string to Renovate config</h3>
<p>The above solution maybe have a downside that all users of the repository (e.g. developers) will also use any <code>.npmrc</code> that is checked into the repository, instead of their own one in <code>~/.npmrc</code>.
To avoid this, you can instead add your <code>.npmrc</code> authentication line to your Renovate config under the field <code>npmrc</code>. e.g. a <code>renovate.json</code> might look like this:</p>
<pre><code class="json">{
  &quot;npmrc&quot;: &quot;//some.registry.com/:_authToken=abcdefghi-1234-jklmno-aac6-12345567889&quot;
}
</code></pre>

<p>If configured like this, Renovate will use this to authenticate with npm and will ignore any <code>.npmrc</code> files(s) it finds checked into the repository.</p>
<h3 id="add-npmtoken-to-renovate-config">Add npmToken to Renovate config</h3>
<p>If you are using the main npmjs registry then you can configure just the npmToken instead:</p>
<pre><code class="json">{
  &quot;npmToken&quot;: &quot;abcdefghi-1234-jklmno-aac6-12345567889&quot;
}
</code></pre>

<h3 id="add-an-encrypted-npm-token-to-renovate-config">Add an encrypted npm token to Renovate config</h3>
<p>If you don't wish for all users of the repository to be able to see the unencrypted token, you can encrypt it with Renovate's public key instead, so that only Renovate can decrypt it.</p>
<p>Go to <a href="https://renovatebot.com/encrypt">https://renovatebot.com/encrypt</a>, paste in your npm token, click "Encrypt", then copy the encrypted result.</p>
<p>Add the encrypted result inside an <code>encrypted</code> object like this:</p>
<pre><code class="json">{
  &quot;encrypted&quot;: {
    &quot;npmToken&quot;: &quot;xxT19RIdhAh09lkhdrK39HzKNBn3etoLZAwHdeJ25cX+5y52a9kAC7flXmdw5JrkciN08aQuRNqDaKxp53IVptB5AYOnQPrt8MCT+x0zHgp4A1zv1QOV84I6uugdWpFSjPUkmLGMgULudEZJMlY/dAn/IVwf/IImqwazY8eHyJAA4vyUqKkL9SXzHjvS+OBonQ/9/AHYYKmDJwT8vLSRCKrXxJCdUfH7ZnikZbFqjnURJ9nGUHP44rlYJ7PFl05RZ+X5WuZG/A27S5LuBvguyQGcw8A2AZilHSDta9S/4eG6kb22jX87jXTrT6orUkxh2WHI/xvNUEout0gxwWMDkA==&quot;
  }
}
</code></pre>

<p>If you have no <code>.npmrc</code> file then Renovate will create one for you, pointing to the default npmjs registry.
If instead you use an alternative registry or need an <code>.npmrc</code> file for some other reason, you should configure it too and substitute the npm token with <code>${NPM_TOKEN}</code> for it to be replaced. e.g.</p>
<pre><code class="json">{
  &quot;encrypted&quot;: {
    &quot;npmToken&quot;: &quot;xxT19RIdhAh09lkhdrK39HzKNBn3etoLZAwHdeJ25cX+5y52a9kAC7flXmdw5JrkciN08aQuRNqDaKxp53IVptB5AYOnQPrt8MCT+x0zHgp4A1zv1QOV84I6uugdWpFSjPUkmLGMgULudEZJMlY/dAn/IVwf/IImqwazY8eHyJAA4vyUqKkL9SXzHjvS+OBonQ/9/AHYYKmDJwT8vLSRCKrXxJCdUfH7ZnikZbFqjnURJ9nGUHP44rlYJ7PFl05RZ+X5WuZG/A27S5LuBvguyQGcw8A2AZilHSDta9S/4eG6kb22jX87jXTrT6orUkxh2WHI/xvNUEout0gxwWMDkA==&quot;
  },
  &quot;npmrc&quot;: &quot;registry=https://my.custom.registry/npm\n//my.custom.registry/npm:_authToken=${NPM_TOKEN}&quot;
}
</code></pre>

<p>Renovate will then use the following logic:</p>
<ol>
<li>If no <code>npmrc</code> string is present in config then one will be created with the <code>_authToken</code> pointing to the default npmjs registry</li>
<li>If an <code>npmrc</code> string is present and contains <code>${NPM_TOKEN}</code> then that placeholder will be replaced with the decrypted token</li>
<li>If an <code>npmrc</code> string is present but doesn't contain <code>${NPM_TOKEN}</code> then the file will have <code>_authToken=&lt;token&gt;</code> appended to it</li>
</ol>
<h3 id="encrypted-entire-npmrc-file-into-config">Encrypted entire .npmrc file into config</h3>
<p>Copy the entire .npmrc, replace newlines with <code>\n</code> chars, and then try encrypting it at <a href="https://renovatebot.com/encrypt">https://renovatebot.com/encrypt</a></p>
<p>You will then get an encrypted string that you can substitute into your renovate.json instead.
The result will now look something like this:</p>
<pre><code class="json">{
  &quot;encrypted&quot;: {
    &quot;npmrc&quot;: &quot;WOTWu+jliBtXYz3CU2eI7dDyMIvSJKS2N5PEHZmLB3XKT3vLaaYTGCU6m92Q9FgdaM/q2wLYun2JrTP4GPaW8eGZ3iiG1cm7lgOR5xPnkCzz0DUmSf6Cc/6geeVeSFdJ0zqlEAhdNMyJ4pUW6iQxC3WJKgM/ADvFtme077Acvc0fhCXv0XvbNSbtUwHF/gD6OJ0r2qlIzUMGJk/eI254xo5SwWVctc1iZS9LW+L0/CKjqhWh4SbyglP3lKE5shg3q7mzWDZepa/nJmAnNmXdoVO2aPPeQCG3BKqCtCfvLUUU/0LvnJ2SbQ1obyzL7vhh2OF/VsATS5cxbHvoX/hxWQ==&quot;
  }
}
</code></pre>

<p>However be aware that if your <code>.npmrc</code> is too long to encrypt then the above command will fail.</p>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../configure-renovate/" title="Configure Renovate (Onboarding PR)" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Configure Renovate (Onboarding PR)
              </span>
            </div>
          </a>
        
        
          <a href="../reconfigure-renovate/" title="Reconfiguring Renovate" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Reconfiguring Renovate
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.c33a9706.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
        <script src="../assets/js/fx.js"></script>
      
    
  </body>
</html>